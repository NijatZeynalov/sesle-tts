var Formoid=function(){var t=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push";function e(t,e){return new Promise((function(r,a){var n=new XMLHttpRequest;n.open(e.type,t),n.onload=function(){if(200!==n.status)return a(new Error("Incorrect server response."));r(n.responseText)},n.onerror=function(){var t="Failed to query the server. ";"onLine"in navigator&&!navigator.onLine?t+="No connection to the Internet.":t+="Check the connection and try again.",a(new Error(t))},n.send(e.data)}))}var r=function(t,e){return t="__"+t+"__",e.length?(this[t]=e[0],this):this[t]},a=function(t){t=t||{},this.__email__=t.email||"",this.__title__=t.title||"",this.__data__=t.data||[],this.__recaptcha__=t.recaptcha||""};return a.prototype.email=function(t){return r.call(this,"email",arguments)},a.prototype.title=function(t){return r.call(this,"title",arguments)},a.prototype.recaptcha_token=function(t){return r.call(this,"recaptcha_token",arguments)},a.prototype.data=function(t){return r.call(this,"data",arguments)},a.prototype.getCaptchaToken=function(){var t=this.__recaptcha__;return new Promise((function(e,r){return t?grecaptcha?void grecaptcha.ready((function(){try{grecaptcha.execute(t,{action:"homepage"}).then(e,r)}catch(t){r(t)}})):r(new Error('"grecaptcha" is not found')):e()}))},a.prototype.send=function(r){return r={email:this.__email__,form:{title:this.__title__,data:arguments.length?r:this.__data__}},this.getCaptchaToken().then((function(a){return a&&(r.recaptcha_token=a),e(t,{type:"POST",data:JSON.stringify(r)})})).then((function(t){try{var e=JSON.parse(t);if(e.error)throw new Error(e.error);return e.response}catch(t){throw new Error("Incorrect server response.")}}))},{Form:function(t){return new a(t)}}}(),isValidEmail=function(t){return!t.value||/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(t.value)},formComponents=document.querySelectorAll('[data-form-type="formoid"]');formComponents.forEach((function(t){var e,r="FORM"===t.tagName?t:t.querySelector("form"),a=t.querySelector("[data-form-alert]"),n=t.getAttribute("data-form-title")?t:t.querySelector("[data-form-title]"),i=t.querySelector('[type="submit"]'),o=t.querySelectorAll("[data-form-field]"),s=a.innerHTML;r.addEventListener("change",(function(t){"file"===t.target.type&&t.target.files[0].size>1e6&&(a.removeAttribute("hidden"),a.classList.remove("alert-success"),a.classList.add("alert-danger"),a.innerHTML="File size must be less than 1mb",i.classList.add("btn-loading"),i.setAttribute("disabled",!0))})),r.addEventListener("submit",(function(c){if(c.stopPropagation(),c.preventDefault(),!i.classList.contains("btn-loading")){var l=o;r.classList.add("form-active"),i.classList.add("btn-loading"),i.setAttribute("disabled",!0),a.innerHTML="",e=e||Formoid.Form({email:t.querySelector("[data-form-email]").value,title:n.getAttribute("data-form-title")||n.innerText,recaptcha:!!r.querySelector("[data-form-captcha]")&&r.querySelector("[data-form-captcha]").value}),Promise.all(Array.prototype.map.call(l,(function(t){return function(t){return new Promise((function(e,r){if("email"===t.getAttribute("name")&&!isValidEmail(t))return r(new Error("Form is not valid"));var a=t.getAttribute("data-form-field")||t.getAttribute("name");switch(t.getAttribute("type")){case"file":var n=t.files[0];if(!n)return e();var i=new FileReader;i.onloadend=function(){e([a,i.result])},i.onerror=function(){r(i.error)},i.readAsDataURL(n);break;case"checkbox":e([a,t.checked?t.value:"No"]);break;case"radio":e(t.checked&&[a,t.value]);break;default:e([a,t.value])}}))}(t)}))).then((function(t){return e.send(t.filter((function(t){return t})))})).then((function(t){r.reset(),r.classList.remove("form-active"),a.innerText=s||t,a.classList.remove("alert-danger"),a.classList.add("alert-success")}),(function(t){a.innerText=t.message,a.classList.remove("alert-success"),a.classList.add("alert-danger")})).then((function(){i.classList.remove("btn-loading"),i.removeAttribute("disabled"),a.removeAttribute("hidden")}))}})),o.forEach((function(t){t.addEventListener("focus",(function(){a.setAttribute("hidden","hidden"),a.classList.add("alert-success"),a.classList.remove("alert-danger"),a.innerHTML="",i.classList.remove("btn-loading"),i.removeAttribute("disabled")}))}))}));